# 解析-核心动画


Q: 图像从文件渲染到屏幕?

`CPU/GPU`协作完成

1. 将图片从磁盘/网络-> UIImage没有 解压.
2. 将UIImage- >UIImageView要解压
3. 隐式动画捕捉图片变换一>图层树(核心动画!)
4. 主线程Runloop捕获.提交隐式动画
* 分配内存缓存区用于读取文件/解压缩
* 文件磁盘读到内存 .png > 位图
* CPU:计算Frame,解压图片，->纹理!
* GPU:硬件加速器.纹理混合!顶点坐标计算，像素点填充计算(片元着色器/片段着色器)一渲染

### GPU渲染流程


* GPU获取图片的顶点坐标
* 将坐标交给顶点着色器(程序GPU)来做计算
* 将光栅化(将顶点数据- ->像素点)
* 向像素点填充颜色(片元着色器程序GPU)
* 注意:片元着色器是图形占有多少像素点,就执行多少填充.并发
* 技术.

图片渲染: 图形 + 图片

![](https://pic-mike.oss-cn-hongkong.aliyuncs.com/Blog/20190313165457.png)

## CALayer


![](https://pic-mike.oss-cn-hongkong.aliyuncs.com/Blog/20190313172504.png)


## 动画

复杂动画  < ===  简单动画的组合

### 仿射变换

 

